\documentclass[11pt,a4paper]{article}
\usepackage[T1]{fontenc}
\usepackage[left=2cm, right=2cm, top=2cm, bottom=2cm]{geometry}
\usepackage{graphicx}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{amsmath}

\usepackage{thmtools}
\usepackage{xcolor}
\usepackage{nameref}
\usepackage[colorlinks=true, linkcolor=blue, citecolor=cyan]{hyperref}
\usepackage{natbib} 
\usepackage{tkz-graph}
\usepackage{placeins}

\usepackage{tikz}
\usepackage{xparse}




\newcommand{\grad}{\operatorname{grad}}
\newcommand{\curl}{\operatorname{curl}}
\renewcommand{\div}{\operatorname{div}}
\newcommand{\img}{\operatorname{img}}
\renewcommand{\span}{\operatorname{span}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\tile}[1]{\fbox{\ensuremath{#1}}}



\theoremstyle{definition}
\newtheorem{definition}{Definition}


\theoremstyle{remark}
\newtheorem{remark}{Remark}

\title{Some topological insights to the tiling problem on $ \Z^d $}
\author{Ali Fele Paranj}


\theoremstyle{definition}
\newtheorem{theorem}{Theorem}
\newtheorem{observation}{Observation}


\begin{document}
	
	\maketitle
	\begin{abstract}
		In this document I will translates some of the problems in tiling self-assembly to the language of analysis and topology, hoping to open some possible ways for using ergodic theory and other interesting analytical tools. 
	\end{abstract}
	
	
	\section{Introduction}
	
	Let's consider the set of all 2D tiles over the final alphabet $\Sigma$. The set of all such possible tilings is 
	$$ \Sigma^{\mathbb{Z}^2}, $$
	which is the same as the set of all functions from $\mathbb{Z}^2$ to $\Sigma$. 
	
	First, observe that since the alphabet is finite, assuming that it has $N$ elements, then one can write $[n] = \{1,2,3,\cdots,n\}$ in place of $\Sigma$. As far as the set structure of $\Sigma$ is considered, it is fine to do so. However, seeing these two spaces as topological spaces, one automatically assumes a discrete topology over the set $\Sigma$, however, in the case of $[n]$ one automatically assumes that 2 is "close" to 1 and 3 and far from $n$. So we might exploit this topological property of the alphabet set in deciding which tilling is plausible and which is not: based on their gluing structure, that a tile of certain type is willing to be close to the tiles of other type. Then one can possibly encode the plausible tiles as functions that are continuous given the topology of their domain $\mathbb{Z}^2$ and their range $\Sigma$. For more about the intuition behind the method see my notes in this \href{https://github.com/alifele/Lecture-Notes/blob/main/Scientific%20Notes/Some%20Intuitions%20on%20Continuous%20Maps/GraphHomologyAndCohomology.pdf}{link}.
	
	
	\section{Simple Setup}
	Define the $ d_1 $ metric on $ \Z^2 $, where
	\[ d_1\left( (n_1,n_2), (m_1,m_2) \right) = |n_1-n_2| + |m_1-m_2|. \]
	This will induce the topology where the smallest open balls are the Moor neighborhoods (see the first chapter of my \href{https://open.library.ubc.ca/soa/cIRcle/collections/ubctheses/24/items/1.0449873}{thesis} for more on this.) Also assume that we have three types of tiles $ \{ \tile{A}, \tile{B}, \tile{C} \}. $ Assuming that every tile can sit with itself (this can be relaxed later by constructing large enough product space), then the notion of ``certain tiles want to it close to certain other tiles'' will induce a partition on the set of tiles (because it is a equivalence relation). Consider the topology whose sub-basis is this partition of the set. The following figure demonstrates this partition.
	
	\input{images/tiles.tex}
	
	Given this ``topology'' on the set of possible tiles, then the following demonstrates two tilings, where the one on the left is a valid tiling, but the one on the right is not a valid tiling.
	
	\input{images/valid_notValid.tex}
	
	\FloatBarrier
	
	So given the intuition above, one can come up with the following theorem
	
	\begin{theorem}
		In the tiling problem above, a tiling is valid, if and only if its corresponding tiling function is continuous.
	\end{theorem}
	
	
	
	\begin{remark}
		One possible way to formulate this is to assume a discrete topology on $ \Z^2 $, which will force every tiling map to be continuous. However, then, the tiling maps corresponding to valid tiling will precisely be the open maps (the maps that the image of open sets are open sets). 
	\end{remark}
	
	
	\section{Tiles with Glue}
	
	In the example above, we only considered some that some of them want to sit with some other ones and do not sit with certain other ones. However, the way that the tiling problem is formulated in the literature is to assume tiles with different combination of glue values on the sides. I think I can convert this problem to the one similar to above, by considering a sufficiently large product space that captures glue-glue interactions. I know that each glue glue interaction can be captured by a matrix, but I an not certain how to define approporiate topology to convert this formulation to the one similar to above.
	
	
	\subsection{One Possible Formulation}
	Let's assume that the set of all possible glues types is given as alphabet $ G $. For instance, if we have 3 types of glue, then one has $ G = \{g_1,g_2,g_3\} $. Assuming that we work in a 2d grid, consider $ T = G^4 $ or equivalently the set of all strings composed of alphabet in $ G $. For instance, if $ G $ is as given above, then
	\[ \mathcal{T} = \{ g_1g_1g_1g_1,\ g_1g_1g_1g_2,\ g_1g_1g_2g_1,\cdots, g_3g_3g_3g_3. \} \]
	This is the set of all possible tiles. Note that given a combination of glue alphabet, we might not have all of the tiles in $ \mathcal{T} $. For instance, for $ G $ as given above, in one problem we might have only two tiles. For instance:
	\input{images/twoTilesWithGlue.tex}
	
	Observe that if we assume that these tiles are floating in some kind of solution, thus can rotation, then the tiles corresponding to the codes $ g_1g_2g_2g_1,\ g_2g_2g_1g_1,\ g_2g_1g_1g_2 $ as well as $ g_3g_1g_3g_2,\ g_1g_3g_2g_3,\ g_3g_2g_3g_1  $ will be possible tiles as well. And if tiles can also flip, then all of the permutations in the dihedral group $ D_4 $ will also be possible tiles. In any case, denote the set of all available tiles as $ T \subset\mathcal{T} $. So for the tiles above, that can not rotate nor flip, we have $ T=\{g_1g_1g_2g_2,\ g_2g_3g_1g_3\}. $
		
		
	Given the set of all glue values, then one has a glue strength map $ s: G\times G \to \mathbb{R}_{+} $. It is straight forward to see that this map is symmetric. Given the minimum strength required for two tiles to bind, denoted by $ \tau $, that represents the notion of temperature in aTAM model, we build two directed graphs $ A_h = (T, E_h) $ and $ A_v = (T,E_v) $, where ``h'' and ``v'' stands for horizontal and vertical respectively, and we have used the standard notation for graph $ G=(V,E) $ where $ V $ represents the set of all vertices, and $ E $ represents the set of all edges. 
	
	Now we want to construct the edge sets $ E_h $ and $ E_v $. In words, there is arrow from $ t_1 $ to $ t_2 $ in $ A_v $ if $ t_2 $ can sit on top of $ t_1 $. And similarly, $ t_1 $ is arrowed (?!) to $ t_2 $ if $ t_2 $ can sit on the right side of $ t_1 $. To write this more formally, first observe that when two tiles bind, then the ``North'' part of one touches the ``South'' part of the other one, or, the ``East'' part of one will touch  the ``West'' part of the other tile. Recall that for the tile $ g_1g_1g_2g_2 $, we assume that the glues are represented in the ``North-East-South-West'' order. In the graph $ A_h $, there is an arrow from $ t_1 $ to $ t_2 $ if $ s(t_1(N), t_2(S)) > \tau $. Similarly, there is an arrow from $ t_1 $ to $ t_2 $ in $ A_h $ if $ s(t_1(E),t_2(W)) > \tau $. For instance, for the example above, and assuming $ \tau=1/2 $, assume the following strength matrix for the glue-glue interaction
	\[ s = \begin{pmatrix}
		1 & 0 & 1 \\
		0 & 1 & 0 \\
		1 & 0 & 0
	\end{pmatrix}, \]
	So the directed graph $ A_v $ and $ A_h $ will be
	\input{images/A_hA_vTwoTiles.tex}
	
	For the sake of completeness, assuming the possibility of rotation, then the set of possible tiles will be
	\input{images/tilesWithRotation.tex}
	
	where for the convenience we have assigned labels for each tile. The $ A_v $ graph for this set of tiles will be as the following graph, where the one on the left is $ A_v $ and the one on the right is $ A_h $.
	
	\begin{figure}[h!]
		\centering
		\includegraphics[width=0.5\linewidth]{images/A_vA_hwithRotation.png}
		\label{fig:graph}
	\end{figure}
	\FloatBarrier
	The computation of these graphs might seem tedious at first glance, however, it is easy to calculate them even by hand. I am yet to think on how to do this algorithmic, but for now I am doing the computations by hand. Here I will explain the simple ``manual'' way to do this, and in the next subsection I will highlight how to use some group theory to make the calculation simpler.
	
	First, we start by constructing $ A_v $. To do this, observe that those tiles that their top edge is $ g_1 $, the tiles that their bottom glue is $ g_1 $ or $ g_3 $ can attach to them (i.e. there will be an arrow from the tile with top glue $ g_1 $ to the tiles that their bottom glue is $ g_1 $ or $ g_3 $). Observe that the tiles $ t_1,t_4 $, and $ t_7 $ all have similar top glue, $ g_1 $. So 
	\[ \tile{t_1},\tile{t_4}, \tile{t_7} \quad\longrightarrow\quad \tile{t_2},\tile{t_3},\tile{t_5},\tile{t_6},\tile{t_8}, \]
	where the diagram above should be interpreted as ``there is an arrow from each of tile on the LHS to all of the tiles in the RHS''. Furthermore, for those with $ g_2 $ sitting on top, since $ g_2 $ only sits with $ g_2 $, there is an arrow from these tiles to only those tiles that have $ g_2 $ at the bottom. So
	\[ \tile{t_2},\tile{t_3},\tile{t_5} \quad\longrightarrow\quad \tile{t_1},\tile{t_4},\tile{t_7}. \]
	And finally, for those tiles with $ g_3 $ on their top, since $ g_3 $ only sits with $ g_1 $, there is an arrow from these tiles to the tiles that have $ g_1 $ at the bottom. So
	\[ \tile{t_6},\tile{t_8} \quad\longrightarrow\quad \tile{t_2},\tile{t_3},\tile{t_5} \]
	Now one can easily draw the corresponding graph.
	
	We can follow a similar procedure for $ A_h $. Using similar arguments as above (but this time using the fact that there is an arrow from tile $ A $ to tile $ B $ if $ B $ can sit on the right hand side of $ A $). So we will have
%	\begin{align*}
%		\tile{t_1},\tile{t_2},\tile{t_8} &\quad\longrightarrow\quad& \tile{t_3},\tile{t_4},\tile{t_6},\tile{t_7}, \\
%		\tile{t_3},\tile{t_4},\tile{t_6} &\quad\longrightarrow\quad& \tile{t_1},\tile{t_2},\tile{t_8}, \\
%		\tile{t_5},\tile{t_7}             &\quad\longrightarrow\quad& \tile{t_3},\tile{t_4},\tile{t_6}
%	\end{align*}
	\[ \tile{t_1},\tile{t_2},\tile{t_8} \quad\longrightarrow\quad \tile{t_3},\tile{t_4},\tile{t_6},\tile{t_7},\tile{t_5}, \]
	\[ \tile{t_3},\tile{t_4},\tile{t_6} \quad\longrightarrow\quad \tile{t_1},\tile{t_2},\tile{t_8}, \]
	\[ \tile{t_5},\tile{t_7} \quad\longrightarrow\quad \tile{t_3},\tile{t_4},\tile{t_6}. \]
	
	There is also another way to compute the $ A_v $ and $ A_h $ graphs, which reveals its connection to the glue strength matrix.  Let $ E $ and $ W $ (stands for ``East'' and ``West'') denote two equivalence relation on the tile set $ T $, where two tiles are related in the sense of $ E $ (i.e. $ t_1\ E\ t_2 $) iff both of them have same glue type on their right hand side. Similarly, two tiles are related in the sense of $ W $ if and only they have a similar glue on their left hand side. Similarly, let $ N $ and $ S $ be the equivalence relations capturing the similarity of glue types on ``North'' and ``South''. To construct the $ A_v $ graph we need the partitions generated by $ N $ and $ S $, however, for $ A_h $ we need the partitions generated by $ W $ and $ E $. Starting with $ A_v $, first, observe that the relation $ N $ induces the following equivalence classes
	\[ [g_1]_N = \{t_1,t_4,t_7\}, \quad [g_2]_N = \{t_2,t_3,t_5\}, \quad [g_3]_N = \{t_6, t_8\}, \] 
	and for $ B $ we have
	\[ [g_1]_S = \{t_2,t_3,t_5\}, \quad [g_2]_S = \{t_1,t_4,t_7\}, \quad [g_3]_S = \{t_6,t_8\}. \]
	And now construct a graph where the edges are these equivalence relations, and we connect $ [g_i]_N $ with an arrow to $ [g_j]_S $ if $ s(g_i,g_j) > \tau $. In other words, the glue matrix will lead to the following connections between these equivalence relations
	\input{images/connectivityBetweenEquivalenceClassesA_v.tex}
	\FloatBarrier
	Similarly, the $ E $ and $ W $ relations will lead to the following partitions:
	\[ [g_1]_E = \{t_1,t_2,t_8\}, \quad [g_2]_E = \{t_3,t_4,t_6\}, \quad [g_3]_E = \{t_5,t_7\}, \]
	and
	\[ [g_1]_W = \{t_3,t_4,t_6\}, \quad [g_2]_W = \{t_1,t_2,t_8\}, \quad [g_3]_W = \{t_7, t_5\} \]
	where the corresponding diagram including the connections will be
	\input{images/connectivityBetweenEquivalenceClassesA_h.tex}
	
	
	
	\subsection{Extension to Non-Square Tiles}
	One can easily apply this idea for the tiles of different shape like hexagonal, or octagonal tile shapes (I am still thinking about applying this for triangles, etc that have odd number of sides). 
	\input{images/hexAndOctTiles.tex}
	However, for these tiles with more number of sides, if we enable the rotation of flipping of tiles, then the tile-tile interaction graph gets very crowded very fast. So we want to utilize as much of the symmetry as possible.
	
	
	\subsubsection{Utilizing the Symmetries}
	
	For now, consider we have three types of glue $ G = \{g_1,g_2,g_3\} $, and only one tile  that has the glue profile $  g_1g_2g_3g_1  $, denoted by $ t $. Furthermore, consider the following glue-glue interaction matrix
	\[ s = \begin{pmatrix}
		0 & 0 & 1 \\
		0 & 1 & 1 \\
		1 & 1 & 1 
	\end{pmatrix}. \]
	 We also enable rotations of the tile, but we do not use the same naming conventions as used above, but instead we fix the permutation $ \sigma $ that rotates the square 90 degrees \textit{counter clockwise}. Thus the set of tiles will be
	\[ T = \{ \sigma^0 t, \sigma^1 t, \sigma^2 t, \sigma^3 t \}. \]
	\input{images/tilesWithRotation_Group.tex}
	Then each of the partitions $ N,E,S,W $ are related in a very interesting way. Enumerating the alphabet position in the tile code $ g_1g_2g_3g_1 $ from $ 0 $ to $ 3 $, it is straight forward to construct the equivalence classes for the $ N $ relation. Since $ g_1 $ has appeared in the 0 and 3 positions, then $ [g_1]_N = \{\sigma^0t, \sigma^3t\} $. Similarly, since $ g_2 $ only occupies the 1 position, then $ [g_2]_N =\{ \sigma^1 t\} $, and lastly $ g_3 $ being on the 2 position we have $ [g_3]_N = \{\sigma^2 t\} $. In short
	\[ [g_1]_N = \{ \sigma^0 t, \sigma^3 t \},\quad [g_2]_N = \{\sigma^1t\}, \quad [g_3]_N = \{ \sigma^2t \}. \]
	Furthermore, observe the following relation between $ N,E,S $, and $ W $ directions:
	\[ N = \sigma^0 N, \qquad W = \sigma^1 N, \qquad S = \sigma^2 N, \qquad E = \sigma^3 N, \]
	where one can interpret the multiplications above as just formal symbolic multiplication as there is no group structure present. Then it is easy to see that
	\[ [g]_{\sigma^n N} = \sigma^n [g]_{N}. \]
	So knowing the equivalence classes for $ N $, and knowing how to transform $ N $ to other relations by rotation $ \sigma $, one can easily calculate the other equivalence relations as follows
	\[ [g]_W = \sigma\cdot [g]_N, \qquad [g]_S = \sigma^2\cdot [g]_N, \qquad [g]_E = \sigma^3\cdot [g]_N, \]
	where the multiplication $ \cdot $ should be interpreted as multiplying every element in the set. Using the glue-glue interaction matrix we will get
	\input{images/simpleExamplePermutationGroup.tex}
 	\FloatBarrier
 	
 	
 	\subsubsection{A Complete Worked Example}
 	
 	To demonstrate the capabilities of this approach, here we are presenting a complete worked example where we have 4 type of glue $ g = \{g_1,g_2,g_3,g_4\} $, and 5 types of tiles
 	\[ T = \{ \tile{t_1},\tile{t_2},\tile{t_3},\tile{t_4},\tile{t_5} \}, \]
 	where
 	\[ t_1=g_3g_1g_4g_2,\quad t_2=g_2g_2g_3g_1,\quad t_3=g_4g_1g_4g_3,\quad t_4=g_1g_3g_2g_2,\quad t_5=g_2g_4g_1g_3. \]
 	Also, assume that the following glue-glue interaction is given:
 	\[ 
 	s = \begin{pmatrix}
 		1 & 1 & 0 & 1\\
 		1 & 1 & 1 & 0\\
 		0 & 1 & 0 & 1\\
 		1 & 0 & 1 & 0
 	\end{pmatrix}.
 	 \]
 	Also assume that we allow rotations. Let $ \sigma $ denote the counterclockwise rotation, i.e. $ \sigma t_1 = g_1g_4g_2g_3 $, and etc. Now it is easy to build the equivalence classes corresponding to the $ N $ relation:
 	\[ [g_1]_N = \{ \sigma^1t_1, \sigma^3t_2, \sigma^1t_3, \sigma^0t_4, \sigma^2t_5 \}, \]
 	\[ [g_2]_N = \{ \sigma^3t_1, \sigma^0t_2, \sigma^1t_2, \sigma^2t_4, \sigma^3t_4, \sigma^0t_5\}, \]
 	\[ [g_3]_N = \{ \sigma^0t_1, \sigma^2t_2, \sigma^3t_3, \sigma^1t_4, \sigma^3t_5 \}, \]
 	\[ [g_4]_N = \{ \sigma^2t_1, \sigma^0t_3, \sigma^2t_3, \sigma^1t_5 \}. \]
 	Using the laws discussed above, it is easy to calculate the equivalence classes for other relations as well. For $ W $:
 	\[ [g_1]_W = \sigma [g_1]_N = \{ \sigma^2t_1, \sigma^0t_2, \sigma^2t_3, \sigma^1t_4, \sigma^3t_5 \}, \]
 	\[ [g_2]_W = \{ \sigma^0t_1, \sigma^1t_2, \sigma^2t_2, \sigma^3t_4, \sigma^0t_4, \sigma^1t_5\}, \]
 	\[ [g_3]_W  = \{ \sigma^1t_1, \sigma^3t_2, \sigma^0t_3, \sigma^2t_4, \sigma^0t_5 \},  \]
 	\[ [g_4]_W = \{ \sigma^3t_1, \sigma^1t_3, \sigma^3t_3, \sigma^2t_5 \}, \]
 	for $ S $:
 	\[ [g_1]_S = \{ \sigma^3t_1, \sigma^1t_2, \sigma^3t_3, \sigma^2t_4, \sigma^0t_5 \}, \]
 	\[ [g_2]_S = \{ \sigma^1t_1, \sigma^2t_2, \sigma^3t_2, \sigma^0t_4, \sigma^1t_4, \sigma^2t_5\}, \]
 	\[ [g_3]_S  = \{ \sigma^2t_1, \sigma^0t_2, \sigma^1t_3, \sigma^3t_4, \sigma^1t_5 \},  \]
 	\[ [g_4]_S = \{ \sigma^0t_1, \sigma^2t_3, \sigma^0t_3, \sigma^3t_5 \}, \]
 	for $ E $:
 	\[ [g_1]_E = \{ \sigma^0t_1, \sigma^2t_2, \sigma^0t_3, \sigma^3t_4, \sigma^1t_5 \}, \]
 	\[ [g_2]_E = \{ \sigma^2t_1, \sigma^3t_2, \sigma^0t_2, \sigma^1t_4, \sigma^2t_4, \sigma^3t_5\}, \]
 	\[ [g_3]_E  = \{ \sigma^3t_1, \sigma^1t_2, \sigma^2t_3, \sigma^0t_4, \sigma^2t_5 \},  \]
 	\[ [g_4]_E = \{ \sigma^1t_1, \sigma^3t_3, \sigma^1t_3, \sigma^0t_5 \}, \]
 	and so on. Using the glue-glue interaction matrix, the connection between partitions will be as follows
 	\input{images/fullExample.tex}
 	\FloatBarrier
 	Using these graphs one can easily check that the following tiling in the form of a question mark is indeed a valid tiling:
 	\input{images/QuestionMark.tex}
 	
	
	
	\section{Discussion}
	The formulation above is very promising for me. One possible reason for this is the following observation:
	\begin{observation}
		Any valid tiling corresponds the branching annihilating random walks on the graph $ A = A_v \oplus A_h $, where $ \oplus $ operation adds a bidirectional edge between two nodes with the same name on $ A_v $ and $ A_h $.
	\end{observation}
	So it opens up lots of useful results form stochastic processes and and probability theory. Furthermore, seeing these graphs as the state space of some Markov chain and the long term properties of this chain can have real world implications of the possible assemblies. 
	
	Furthermore, one can add different weights to the edges, corresponding to the strength of the corresponding glue-glue interaction. Then certain path's on the graph will be more probable than the other ones, and using the observation above, regarding the correspondence between branching-annihilating walks on $ A $ and valid tile assemblies, this translates to higher possibility of observing certain assemblies compared to other ones.
	
	Also, the graph $ A $ if very similar to the state space of a Turing machine, and I am also curious to see what will be the tiling implications of certain finite automate designs, like the ones that can detect certain string patterns etc.
	
	Furthermore, encoding all the valid tilings in $ A $, then one can design ``smart'' tiles. For instance, the tiles that are dead end and once a random walker gets there can not get out. This kind of tile would correspond to the ``capping'' tiles that stop the growth in certain direction.
	
	Furthermore, it is very straightforward to extend this formulation for cubic tiles in 3D, or other tiles like hexagonal tiles in 2D. For instance, in the case of $ 3D $ cubes, if we allow rotation, then we would have two rotation operators $ \sigma $ and $ \tau $, and we will consider different powers of these operators from 0 to 3. In the case of hexagonal lattice, we will still have one rotation $ \sigma $, which is 60 degrees counterclockwise rotation, and we will have the powers $ 0 $ to $ 5 $ of this operator. So different tiling grids and different dimensions will only translate to richer rotation operators.  
	
	
	
\end{document}